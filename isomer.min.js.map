{"version":3,"file":"isomer.min.js","sources":["isomer.js"],"names":["Sprites","urls","this","Layer","z","items","map","world","World","options","canvas","ctx","getContext","webkitspritesmoothingEnabled","width","height","cell","cx","cy","center","x","y","projection","project","layers","_changed","init","Item","sprite","sx","sy","animations","_discovered","Block","call","Player","Animation","item","props","interval","callback","frames","initial","start","prototype","load","ids","Object","keys","length","sprites","forEach","id","img","Image","onload","src","has","indexOf","render","tick","lx","rx","ly","ry","i","len","neighbors","player","globalAlpha","covers","animation","add","insert","push","pos","search","compare","splice","get","remove","index","sort","a","b","needle","stack","comparator","j","middle","cmp","self","onframe","window","webkitRequestAnimationFrame","RequestAnimationFrame","Math","round","save","clearRect","translate","random","restore","layer","getLayer","addLayer","setPlayer","setCenter","handleMove","position","offset","w","h","move","dx","dy","dz","dist","animate","first","run","shift","end","reset","create","constructor","drawImage","command","cmd","percent","frame","transform"],"mappings":"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"}